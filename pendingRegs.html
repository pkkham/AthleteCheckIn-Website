<!doctype html>
<html lang=''>
	<style>
		h1.h1 {
			color: white;
            padding: 1cm 0cm 0cm 0cm;
			font-family: Raleway, sans-serif;
			text-align: center;
		}
		p.p1 {
			color:orange;
			padding:0cm 0cm 0cm 2cm;
		}
		table{
			color:#03244d;
			border: 1px solid black;
			border-collapse:collapse;
			font-family: Raleway, sans-serif;
			text-align: center;
			border-radius: 12px;
    		border-collapse: collapse;
            margin: 0px auto;
		}
		thead,tr,th,td{
			border: 1px solid black;
			border-collapse:collapse;
			font-family: Raleway, sans-serif;
			padding: 10px;
		}
        table tr {
            background-color:#fff6e6;
        }
		tr:hover{
			background-color: #9a9a9a
		}
		td:input:checked{
			background-color:#68f472
		}
		th{
			background-color: #dd550c;
		}
        
        form {
            text-align: center;
        }
        
	</style>
	<head>
		<meta charset='utf-8'>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="css/tabs.css">
		<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
		<script src="script.js"></script>
		<title>
			Pending Registrations - Athlete Check-In
		</title>
        
	</head>
	<body>
		<div id='cssmenu'>
			<ul>
                <li>
					<a href='athletes.html'>View Athletes</a>
				</li>
				<li class='active'>
					<a href='#'>Pending Registrations</a>
				</li>
				<li>
					<a href='upload.html'>Upload a File</a>
				</li>
			</ul>
		</div>
		<h1 class="h1" align="center">
			Pending Registrations
		</h1>
        
        <table>
			<thead>
				<tr>
                    <th>
                        
                    </th>
					<th>
						Email
					</th>
                    <th>
                        Username
                    </th>
					<th>
						Date of Request
					</th>
				</tr>
			</thead>
            
			<?php require dirname(__FILE__).'/server_api/include/DB_Functions.php';
                $db = new DB_Functions();
                $regs = $db->getPendingAdminRegistrations();
                foreach ($regs as &$reg) {
	               echo "<tr><td> <input type=\"checkbox\" name=\"". $reg["username"] . "\"/> </td>";
                   echo "<td>".$reg["email"]."</td>";
	               echo "<td>".$reg["username"]."</td>";
                   echo "<td>".$reg["register_date"]."</td>";
	               echo "</tr>";
                }
			?>
		</table>
        <br>
        <form method="POST" >
            <input type="submit" value="Approve" class="button button-pending" name="approve" />
            <input type="submit" value="Deny" class="button button-pending" name="deny" />
        </form>
        
        
        <?php
            if (isset($_POST['approve'])) {
                foreach ($regs as &$reg) {
                    if (isset($_POST[$reg["username"] . ""])) {;
                        $db->approveAdmin($reg);
                    }
                }
                echo '<meta http-equiv="refresh" content="0; url=http://conquestiamc.com/pendingRegs.html">';
            } elseif (isset($_POST['deny'])) {
                foreach ($regs as $reg) {
                    if (isset($_POST[$reg["username"] . ""])) {
                        $db->removePendingAdmin($reg);
                    }
                }
                echo '<meta http-equiv="refresh" content="0; url=http://conquestiamc.com/pendingRegs.html">';
            }
        ?>
	</body>
<html>
		